<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>TombEngine 1.11 Lua API</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>&nbsp;TombEngine</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>1 Special Tables</h2>
<ul class="nowrap">
  <li>    <a href="../1 special tables/GameVars.html">GameVars</a></li>
  <li>    <here>LevelFuncs</here></li>
  <li>    <a href="../1 special tables/LevelVars.html">LevelVars</a></li>
</ul>
<h2>2 Modules</h2>
<ul class="nowrap">
  <li>    <a href="../2 modules/Effects.html">Effects</a></li>
  <li>    <a href="../2 modules/Flow.html">Flow</a></li>
  <li>    <a href="../2 modules/Input.html">Input</a></li>
  <li>    <a href="../2 modules/Inventory.html">Inventory</a></li>
  <li>    <a href="../2 modules/Logic.html">Logic</a></li>
  <li>    <a href="../2 modules/Objects.html">Objects</a></li>
  <li>    <a href="../2 modules/Sound.html">Sound</a></li>
  <li>    <a href="../2 modules/Strings.html">Strings</a></li>
  <li>    <a href="../2 modules/Util.html">Util</a></li>
  <li>    <a href="../2 modules/View.html">View</a></li>
</ul>
<h2>3 Classes</h2>
<ul class="nowrap">
  <li>    <a href="../3 classes/Collision.Ray.html">Collision.Ray</a></li>
  <li>    <a href="../3 classes/Collision.Probe.html">Collision.Probe</a></li>
  <li>    <a href="../3 classes/Flow.Level.html">Flow.Level</a></li>
  <li>    <a href="../3 classes/Flow.Settings.html">Flow.Settings</a></li>
  <li>    <a href="../3 classes/Flow.Statistics.html">Flow.Statistics</a></li>
  <li>    <a href="../3 classes/Objects.AIObject.html">Objects.AIObject</a></li>
  <li>    <a href="../3 classes/Objects.Camera.html">Objects.Camera</a></li>
  <li>    <a href="../3 classes/Objects.LaraObject.html">Objects.LaraObject</a></li>
  <li>    <a href="../3 classes/Objects.Moveable.html">Objects.Moveable</a></li>
  <li>    <a href="../3 classes/Objects.Room.html">Objects.Room</a></li>
  <li>    <a href="../3 classes/Objects.Sink.html">Objects.Sink</a></li>
  <li>    <a href="../3 classes/Objects.SoundSource.html">Objects.SoundSource</a></li>
  <li>    <a href="../3 classes/Objects.Static.html">Objects.Static</a></li>
  <li>    <a href="../3 classes/Objects.Volume.html">Objects.Volume</a></li>
  <li>    <a href="../3 classes/Strings.DisplayString.html">Strings.DisplayString</a></li>
  <li>    <a href="../3 classes/View.DisplayItem.html">View.DisplayItem</a></li>
  <li>    <a href="../3 classes/View.DisplaySprite.html">View.DisplaySprite</a></li>
</ul>
<h2>4 Primitive Classes</h2>
<ul class="nowrap">
  <li>    <a href="../4 primitive classes/Flow.Fog.html">Flow.Fog</a></li>
  <li>    <a href="../4 primitive classes/Flow.Horizon.html">Flow.Horizon</a></li>
  <li>    <a href="../4 primitive classes/Flow.InventoryItem.html">Flow.InventoryItem</a></li>
  <li>    <a href="../4 primitive classes/Flow.LensFlare.html">Flow.LensFlare</a></li>
  <li>    <a href="../4 primitive classes/Flow.SkyLayer.html">Flow.SkyLayer</a></li>
  <li>    <a href="../4 primitive classes/Flow.Starfield.html">Flow.Starfield</a></li>
  <li>    <a href="../4 primitive classes/Color.html">Color</a></li>
  <li>    <a href="../4 primitive classes/Rotation.html">Rotation</a></li>
  <li>    <a href="../4 primitive classes/Time.html">Time</a></li>
  <li>    <a href="../4 primitive classes/Vec2.html">Vec2</a></li>
  <li>    <a href="../4 primitive classes/Vec3.html">Vec3</a></li>
  <li>    <a href="../4 primitive classes/View.DisplayAnchors.html">View.DisplayAnchors</a></li>
</ul>
<h2>5 Enums</h2>
<ul class="nowrap">
  <li>    <a href="../5 enums/Collision.IntersectionType.html">Collision.IntersectionType</a></li>
  <li>    <a href="../5 enums/Collision.MaterialType.html">Collision.MaterialType</a></li>
  <li>    <a href="../5 enums/Effects.BlendID.html">Effects.BlendID</a></li>
  <li>    <a href="../5 enums/Effects.EffectID.html">Effects.EffectID</a></li>
  <li>    <a href="../5 enums/Effects.StreamerFeatherMode.html">Effects.StreamerFeatherMode</a></li>
  <li>    <a href="../5 enums/Effects.ParticleAnimationType.html">Effects.ParticleAnimationType</a></li>
  <li>    <a href="../5 enums/Flow.ErrorMode.html">Flow.ErrorMode</a></li>
  <li>    <a href="../5 enums/Flow.FreezeMode.html">Flow.FreezeMode</a></li>
  <li>    <a href="../5 enums/Flow.GameStatus.html">Flow.GameStatus</a></li>
  <li>    <a href="../5 enums/Flow.ItemAction.html">Flow.ItemAction</a></li>
  <li>    <a href="../5 enums/Flow.LaraType.html">Flow.LaraType</a></li>
  <li>    <a href="../5 enums/Flow.PathfindingMode.html">Flow.PathfindingMode</a></li>
  <li>    <a href="../5 enums/Flow.WeatherType.html">Flow.WeatherType</a></li>
  <li>    <a href="../5 enums/Input.ActionID.html">Input.ActionID</a></li>
  <li>    <a href="../5 enums/Input.AxisID.html">Input.AxisID</a></li>
  <li>    <a href="../5 enums/Logic.CallbackPoint.html">Logic.CallbackPoint</a></li>
  <li>    <a href="../5 enums/Logic.EventType.html">Logic.EventType</a></li>
  <li>    <a href="../5 enums/Logic.EndReason.html">Logic.EndReason</a></li>
  <li>    <a href="../5 enums/Objects.AmmoType.html">Objects.AmmoType</a></li>
  <li>    <a href="../5 enums/Objects.HandStatus.html">Objects.HandStatus</a></li>
  <li>    <a href="../5 enums/Objects.WaterStatus.html">Objects.WaterStatus</a></li>
  <li>    <a href="../5 enums/Objects.WeaponMode.html">Objects.WeaponMode</a></li>
  <li>    <a href="../5 enums/Objects.WeaponType.html">Objects.WeaponType</a></li>
  <li>    <a href="../5 enums/Objects.InteractionType.html">Objects.InteractionType</a></li>
  <li>    <a href="../5 enums/Objects.MoveableStatus.html">Objects.MoveableStatus</a></li>
  <li>    <a href="../5 enums/Objects.ObjID.html">Objects.ObjID</a></li>
  <li>    <a href="../5 enums/Objects.RoomFlagID.html">Objects.RoomFlagID</a></li>
  <li>    <a href="../5 enums/Objects.RoomReverb.html">Objects.RoomReverb</a></li>
  <li>    <a href="../5 enums/Sound.SoundTrackType.html">Sound.SoundTrackType</a></li>
  <li>    <a href="../5 enums/Strings.DisplayStringOption.html">Strings.DisplayStringOption</a></li>
  <li>    <a href="../5 enums/Util.LogLevel.html">Util.LogLevel</a></li>
  <li>    <a href="../5 enums/View.AlignMode.html">View.AlignMode</a></li>
  <li>    <a href="../5 enums/View.CameraType.html">View.CameraType</a></li>
  <li>    <a href="../5 enums/View.PostProcessMode.html">View.PostProcessMode</a></li>
  <li>    <a href="../5 enums/View.ScaleMode.html">View.ScaleMode</a></li>
</ul>
<h2>6 Lua utility modules</h2>
<ul class="nowrap">
  <li>    <a href="../6 lua utility modules/CustomBar.html">CustomBar</a></li>
  <li>    <a href="../6 lua utility modules/CustomDiary.html">CustomDiary</a></li>
  <li>    <a href="../6 lua utility modules/EventSequence.html">EventSequence</a></li>
  <li>    <a href="../6 lua utility modules/Timer.html">Timer</a></li>
  <li>    <a href="../6 lua utility modules/Type.html">Type</a></li>
</ul>

</div>

<div id="content">

<h1>Table <code>LevelFuncs</code></h1>
<p>A hierarchical table system for organizing level-specific functions.</p>
<p>

<p> This serves a few purposes: it holds the level callbacks (listed below) as well as
 any trigger functions you might have specified.</p>

<p> For example, if you give a trigger a Lua name of "my_trigger" in Tomb Editor, you will have to implement it as a member
 of this table:</p>

<pre>
LevelFuncs.my_trigger = <span class="keyword">function</span>()
    <span class="comment">--implementation goes here
</span><span class="keyword">end</span>
</pre>

<p> You can organise functions into tables within the hierarchy:</p>

<pre>
LevelFuncs.enemyFuncs = {}

LevelFuncs.enemyFuncs.makeBaddyRunAway = <span class="keyword">function</span>()
    <span class="comment">--implementation goes here
</span><span class="keyword">end</span>

LevelFuncs.enemyFuncs.makeBaddyUseMedkit = <span class="keyword">function</span>()
    <span class="comment">--implementation goes here
</span><span class="keyword">end</span>
</pre>

<p> <h2>Level Callbacks</h2>
 The level's .lua file contains predefined functions, called callbacks, that will be called on specific events in the level. If you want to execute code or call other functions in these events, you'll need to place them inside these functions.</p>

<p> The functions are:</p>

<ul>
    <li><strong>OnStart</strong> Will be called when a level is entered by completing a previous level or by selecting it in the menu. Will not be called when loaded from a saved game.</li>
    <li><strong>OnLoad</strong> Will be called when a level is loaded from a saved game.</li>
    <li><strong>OnLoop</strong> Will be called once per frame while the level is active.</li>
    <li><strong>OnSave</strong> Will be called when the game is saved while in the level.</li>
    <li><strong>OnEnd</strong> Will be called when leaving a level. This includes finishing it, exiting to the menu, or loading a save in a different level. It can take an <a href="../5 enums/Logic.EndReason.html#">Logic.EndReason</a>.
<br>For example:

<pre>
LevelFuncs.OnEnd = <span class="keyword">function</span>(reason)
    <span class="keyword">if</span> reason == TEN.Logic.EndReason.LEVEL_COMPLETE <span class="keyword">then</span>
        <span class="comment">--implementation goes here
</span>    <span class="keyword">end</span>
    <span class="keyword">if</span> reason == TEN.Logic.EndReason.DEATH <span class="keyword">then</span>
        <span class="global">print</span>(<span class="string">"death"</span>)
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre>
</li>
    <li><strong>OnUseItem</strong> Will be called when the player uses an item from their inventory. It can take a <a href="../5 enums/Objects.ObjID.html#">Objects.ObjID</a>.
<br>For example:

<pre>
LevelFuncs.OnUseItem = <span class="keyword">function</span>(itemID)
    <span class="keyword">if</span> itemID == TEN.Objects.ObjID.SMALLMEDI_ITEM <span class="keyword">then</span>
        <span class="comment">--implementation goes here
</span>    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre>
</li>
    <li><strong>OnFreeze</strong> Will be called when any of the Freeze modes are activated.</li>
</ul>

<p> <br><strong>The order of loading is as follows:</strong></p>

<ol>
    <li><p>The level data itself is loaded.</p></li>
    <li><p>The level script itself is run (i.e. any code you put outside the <a href="../1 special tables/LevelFuncs.html#">LevelFuncs</a> callbacks is executed).</p></li>
    <li><p>Save data is loaded, if saving from a saved game (will empty <a href="../1 special tables/LevelVars.html#">LevelVars</a> and <a href="../1 special tables/GameVars.html#">GameVars</a> and repopulate them with what they contained when the game was saved).</p></li>
    <li><p>If loading from a save, OnLoad will be called. Otherwise, OnStart will be called.</p></li>
    <li><p>The control loop, in which OnLoop will be called once per frame, begins.</p></li>
</ol>

<p> <h2>Note:</h2></p>

<ul>
    <li>LevelFuncs is created automatically. Never assign a value to LevelFuncs itself, as that will overwrite the entire table.<br>
For example, do NOT do this:

<pre>
LevelFuncs = {} <span class="comment">-- This will break everything!</span>
</pre>

or

<pre>
LevelFuncs = LevelFuncs <span class="comment">-- not needed, LevelFuncs already exists.</span>
</pre>
</li>
    <li><strong><em>LevelFuncs.External</em></strong> is for 'third-party' functions.<br>
For example, if you write a library providing LevelFuncs functions for other builders to use in their levels, put those functions in:

<pre>
LevelFuncs.External.YourLibraryNameHere = {}
LevelFuncs.External.YourLibraryNameHere.yourFunction = <span class="keyword">function</span>()
    <span class="comment">--implementation goes here
</span><span class="keyword">end</span>
LevelFuncs.External.YourLibraryNameHere.yourFunction2 = <span class="keyword">function</span>()
    <span class="comment">--implementation goes here
</span><span class="keyword">end</span>
</pre>
</li>
    <li><strong><em>LevelFuncs.Engine</em></strong> is a reserved table used internally by TombEngine's libs. <strong>Do not modify, overwrite, or add to it.</strong></li>
</ul>
</p>



<br/>
<br/>




</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="https://github.com/hispidence/TEN-LDoc">TEN-LDoc</a> (a fork of <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a>)</i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
